<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="829.8px" preserveAspectRatio="none" style="width:592px;height:829px;" version="1.1" viewBox="0 0 592 829" width="592.8px" zoomAndPan="magnify"><defs><filter height="300%" id="f1d7alnur0wnco" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2000000476837158"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4000000953674316" dy="2.4000000953674316" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="10.8" lengthAdjust="spacingAndGlyphs" textLength="194.4" x="196.8" y="16.0248">Алгоритм обновление состояния</text><text fill="#000000" font-family="sans-serif" font-size="10.8" lengthAdjust="spacingAndGlyphs" textLength="108" x="243.6" y="28.5967">входящих звонков</text><ellipse cx="241.125" cy="37.1438" fill="#000000" filter="url(#f1d7alnur0wnco)" rx="6" ry="6" style="stroke: none; stroke-width: 0.6000000238418579;"/><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="28.7625" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="102.6" x="189.825" y="55.1438"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="88.2" x="195.825" y="67.827">Получение сообщения</text><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="87" x="195.825" y="76.2082">FullCallList/ShortCallList</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="157.8" x="162.225" y="95.9063"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="145.8" x="168.225" y="108.5895">Сериалиация в структуру FullCallsList</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="139.2" x="171.525" y="128.2875"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="127.2" x="177.525" y="140.9707">Отправка сообщения в очередь</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="147.6" x="167.325" y="160.6688"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="135.6" x="173.325" y="173.352">Получение сообщения из очереди</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="183.525,193.05,298.725,193.05,305.925,200.25,298.725,207.45,183.525,207.45,176.325,200.25,183.525,193.05" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="115.2" x="183.525" y="202.5349">Состояние звонка - завершено?</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="9" x="167.325" y="198.6935">да</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="12.6" x="305.925" y="198.6935">нет</text><rect fill="#FFFFFF" filter="url(#f1d7alnur0wnco)" height="145.3031" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="187.2" x="6" y="242.4914"/><path d="M99.6,243.0914 L99.6,248.0695 L93.6,254.0695 L6,254.0695 " fill="none" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="87.6" x="7.8" y="250.8885">Завершение звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="28.7625" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="142.2" x="28.5" y="264.2695"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="127.8" x="34.5" y="276.9527">Установка времени завершения</text><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="66" x="34.5" y="285.334">у каждого плеча</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="175.2" x="12" y="314.032"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="163.2" x="18" y="326.7152">Установка времени завершения у звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="174" x="12.6" y="355.4133"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="162" x="18.6" y="368.0965">Перевод звонка в состояние "завершен"</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="112.8" x="43.2" y="408.7945"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="100.8" x="49.2" y="421.4778">Удаление звонка из кэша</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="163.8" x="17.7" y="450.1758"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="151.8" x="23.7" y="462.859">Преобразование в формат данных БД</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="78.6" x="60.3" y="483.5344"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="66.6" x="66.3" y="496.2176">Сохранение в БД</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="61.8,213.45,137.4,213.45,144.6,220.65,137.4,227.85,61.8,227.85,54.6,220.65,61.8,213.45" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="9" x="102" y="233.9763">да</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="75.6" x="61.8" y="222.9349">Звонок есть в кэше?</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="99.6,518.5571,106.8,525.7571,99.6,532.9571,92.4,525.7571,99.6,518.5571" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1d7alnur0wnco)" height="258.0844" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="367.8" x="218.4" y="213.45"/><path d="M300,214.05 L300,219.0281 L294,225.0281 L218.4,225.0281 " fill="none" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="75.6" x="220.2" y="221.8471">Создание звонка</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="344.85,235.2281,420.45,235.2281,427.65,242.4281,420.45,249.6281,344.85,249.6281,337.65,242.4281,344.85,235.2281" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="75.6" x="344.85" y="244.713">Звонок есть в кэше?</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="9" x="328.65" y="240.8716">да</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="12.6" x="427.65" y="240.8716">нет</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="124.2" x="230.4" y="255.6281"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="112.2" x="236.4" y="268.3113">Обновление состояние плеч</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="96" x="424.8" y="255.6281"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="84" x="430.8" y="268.3113">Создание новых плеч</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="124.2" x="410.7" y="297.0094"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="112.2" x="416.7" y="309.6926">Обновление состояние плеч</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="117" x="414.3" y="338.3906"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="105" x="420.3" y="351.0738">Определение типа звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="212.4" x="366.6" y="379.7719"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="200.4" x="372.6" y="392.4551">Создание нового звонка соответствующего типа</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="113.4" x="416.1" y="421.1531"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="101.4" x="422.1" y="433.8363">Добавление звонка в кэш</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="382.65,445.1344,389.85,452.3344,382.65,459.5344,375.45,452.3344,382.65,445.1344" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><rect fill="#FFFFFF" filter="url(#f1d7alnur0wnco)" height="144.4336" style="stroke: #000000; stroke-width: 1.2000000476837158;" width="148.8" x="311.85" y="484.5117"/><path d="M404.85,485.1117 L404.85,490.0899 L398.85,496.0899 L311.85,496.0899 " fill="none" style="stroke: #000000; stroke-width: 1.2000000476837158;"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="87" x="313.65" y="492.9088">Обновление звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="90.6" x="337.35" y="506.2899"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="343.35" y="518.9731">Обновление данных</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="117.6" x="323.85" y="574.9641"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="105.6" x="329.85" y="587.6473">Сохранение звонка в Redis</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="327.45,544.9571,437.85,544.9571,445.05,552.6399,437.85,560.3227,327.45,560.3227,320.25,552.6399,327.45,544.9571" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.05" y="566.4489">да</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="82.8" x="327.45" y="551.0833">Звонка нет в Redis &amp;&amp;</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="110.4" x="327.45" y="558.7661">звонок прикреплен к проекту?</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="382.65,607.3453,389.85,614.5453,382.65,621.7453,375.45,614.5453,382.65,607.3453" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="90.6" x="337.35" y="669.9867"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="78.6" x="343.35" y="682.6699">Завершение звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="79.8" x="342.75" y="702.368"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="67.8" x="348.75" y="715.0512">Создание звонка</text><rect fill="#FEFECE" filter="url(#f1d7alnur0wnco)" height="20.3813" rx="7.5" ry="7.5" style="stroke: #A80036; stroke-width: 0.9000000357627869;" width="113.4" x="325.95" y="734.7492"/><text fill="#000000" font-family="sans-serif" font-size="7.2" lengthAdjust="spacingAndGlyphs" textLength="101.4" x="331.95" y="747.4325">Добавление звонка в кэш</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="319.05,640.9453,446.25,640.9453,453.45,648.1453,446.25,655.3453,319.05,655.3453,311.85,648.1453,319.05,640.9453" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="9" x="385.05" y="661.4716">да</text><text fill="#000000" font-family="sans-serif" font-size="6.6" lengthAdjust="spacingAndGlyphs" textLength="127.2" x="319.05" y="650.4302">Прикрепленный проект изменился?</text><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="382.65,767.1305,389.85,774.3305,382.65,781.5305,375.45,774.3305,382.65,767.1305" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><polygon fill="#FEFECE" filter="url(#f1d7alnur0wnco)" points="241.125,785.1305,248.325,792.3305,241.125,799.5305,233.925,792.3305,241.125,785.1305" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><ellipse cx="241.125" cy="817.5305" fill="none" filter="url(#f1d7alnur0wnco)" rx="6" ry="6" style="stroke: #000000; stroke-width: 0.6000000238418579;"/><ellipse cx="241.425" cy="817.8305" fill="#000000" filter="url(#f1d7alnur0wnco)" rx="3.6" ry="3.6" style="stroke: none; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="43.1438" y2="55.1438"/><polygon fill="#A80036" points="238.725,49.1438,241.125,55.1438,243.525,49.1438,241.125,51.5438" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="83.9063" y2="95.9063"/><polygon fill="#A80036" points="238.725,89.9063,241.125,95.9063,243.525,89.9063,241.125,92.3063" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="116.2875" y2="128.2875"/><polygon fill="#A80036" points="238.725,122.2875,241.125,128.2875,243.525,122.2875,241.125,124.6875" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="148.6688" y2="160.6688"/><polygon fill="#A80036" points="238.725,154.6688,241.125,160.6688,243.525,154.6688,241.125,157.0688" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="293.032" y2="314.032"/><polygon fill="#A80036" points="97.2,308.032,99.6,314.032,102,308.032,99.6,310.432" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="334.4133" y2="355.4133"/><polygon fill="#A80036" points="97.2,349.4133,99.6,355.4133,102,349.4133,99.6,351.8133" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="375.7945" y2="408.7945"/><polygon fill="#A80036" points="97.2,402.7945,99.6,408.7945,102,402.7945,99.6,405.1945" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="429.1758" y2="450.1758"/><polygon fill="#A80036" points="97.2,444.1758,99.6,450.1758,102,444.1758,99.6,446.5758" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="470.557" y2="483.5344"/><polygon fill="#A80036" points="97.2,477.5344,99.6,483.5344,102,477.5344,99.6,479.9344" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="227.85" y2="264.2695"/><polygon fill="#A80036" points="97.2,258.2695,99.6,264.2695,102,258.2695,99.6,260.6695" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="144.6" x2="199.2" y1="220.65" y2="220.65"/><polygon fill="#A80036" points="196.8,371.2149,199.2,377.2149,201.6,371.2149,199.2,373.6149" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="199.2" x2="199.2" y1="220.65" y2="525.7571"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="199.2" x2="106.8" y1="525.7571" y2="525.7571"/><polygon fill="#A80036" points="112.8,523.3571,106.8,525.7571,112.8,528.1571,110.4,525.7571" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="503.9156" y2="518.5571"/><polygon fill="#A80036" points="97.2,512.5571,99.6,518.5571,102,512.5571,99.6,514.9571" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="276.0094" y2="297.0094"/><polygon fill="#A80036" points="470.4,291.0094,472.8,297.0094,475.2,291.0094,472.8,293.4094" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="317.3906" y2="338.3906"/><polygon fill="#A80036" points="470.4,332.3906,472.8,338.3906,475.2,332.3906,472.8,334.7906" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="358.7719" y2="379.7719"/><polygon fill="#A80036" points="470.4,373.7719,472.8,379.7719,475.2,373.7719,472.8,376.1719" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="400.1531" y2="421.1531"/><polygon fill="#A80036" points="470.4,415.1531,472.8,421.1531,475.2,415.1531,472.8,417.5531" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="337.65" x2="292.5" y1="242.4281" y2="242.4281"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="292.5" x2="292.5" y1="242.4281" y2="255.6281"/><polygon fill="#A80036" points="290.1,249.6281,292.5,255.6281,294.9,249.6281,292.5,252.0281" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="427.65" x2="472.8" y1="242.4281" y2="242.4281"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="242.4281" y2="255.6281"/><polygon fill="#A80036" points="470.4,249.6281,472.8,255.6281,475.2,249.6281,472.8,252.0281" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="292.5" x2="292.5" y1="276.0094" y2="452.3344"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="292.5" x2="375.45" y1="452.3344" y2="452.3344"/><polygon fill="#A80036" points="369.45,449.9344,375.45,452.3344,369.45,454.7344,371.85,452.3344" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="472.8" y1="441.5344" y2="452.3344"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="472.8" x2="389.85" y1="452.3344" y2="452.3344"/><polygon fill="#A80036" points="395.85,449.9344,389.85,452.3344,395.85,454.7344,393.45,452.3344" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="560.3227" y2="574.9641"/><polygon fill="#A80036" points="380.25,568.9641,382.65,574.9641,385.05,568.9641,382.65,571.3641" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="445.05" x2="452.25" y1="552.6399" y2="552.6399"/><polygon fill="#A80036" points="449.85,578.9133,452.25,584.9133,454.65,578.9133,452.25,581.3133" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="452.25" x2="452.25" y1="552.6399" y2="614.5453"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="452.25" x2="389.85" y1="614.5453" y2="614.5453"/><polygon fill="#A80036" points="395.85,612.1453,389.85,614.5453,395.85,616.9453,393.45,614.5453" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="595.3453" y2="607.3453"/><polygon fill="#A80036" points="380.25,601.3453,382.65,607.3453,385.05,601.3453,382.65,603.7453" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="526.6711" y2="544.9571"/><polygon fill="#A80036" points="380.25,538.9571,382.65,544.9571,385.05,538.9571,382.65,541.3571" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="459.5344" y2="506.2899"/><polygon fill="#A80036" points="380.25,500.2899,382.65,506.2899,385.05,500.2899,382.65,502.6899" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="690.368" y2="702.368"/><polygon fill="#A80036" points="380.25,696.368,382.65,702.368,385.05,696.368,382.65,698.768" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="722.7492" y2="734.7492"/><polygon fill="#A80036" points="380.25,728.7492,382.65,734.7492,385.05,728.7492,382.65,731.1492" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="655.3453" y2="669.9867"/><polygon fill="#A80036" points="380.25,663.9867,382.65,669.9867,385.05,663.9867,382.65,666.3867" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="453.45" x2="460.65" y1="648.1453" y2="648.1453"/><polygon fill="#A80036" points="458.25,706.5586,460.65,712.5586,463.05,706.5586,460.65,708.9586" style="stroke: #A80036; stroke-width: 0.9000000357627869;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="460.65" x2="460.65" y1="648.1453" y2="774.3305"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="460.65" x2="389.85" y1="774.3305" y2="774.3305"/><polygon fill="#A80036" points="395.85,771.9305,389.85,774.3305,395.85,776.7305,393.45,774.3305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="755.1305" y2="767.1305"/><polygon fill="#A80036" points="380.25,761.1305,382.65,767.1305,385.05,761.1305,382.65,763.5305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="621.7453" y2="640.9453"/><polygon fill="#A80036" points="380.25,634.9453,382.65,640.9453,385.05,634.9453,382.65,637.3453" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="176.325" x2="99.6" y1="200.25" y2="200.25"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="200.25" y2="213.45"/><polygon fill="#A80036" points="97.2,207.45,99.6,213.45,102,207.45,99.6,209.85" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="305.925" x2="382.65" y1="200.25" y2="200.25"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="200.25" y2="235.2281"/><polygon fill="#A80036" points="380.25,229.2281,382.65,235.2281,385.05,229.2281,382.65,231.6281" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="99.6" y1="532.9571" y2="792.3305"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="99.6" x2="233.925" y1="792.3305" y2="792.3305"/><polygon fill="#A80036" points="227.925,789.9305,233.925,792.3305,227.925,794.7305,230.325,792.3305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="382.65" y1="781.5305" y2="792.3305"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="382.65" x2="248.325" y1="792.3305" y2="792.3305"/><polygon fill="#A80036" points="254.325,789.9305,248.325,792.3305,254.325,794.7305,251.925,792.3305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="181.05" y2="193.05"/><polygon fill="#A80036" points="238.725,187.05,241.125,193.05,243.525,187.05,241.125,189.45" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><line style="stroke: #A80036; stroke-width: 0.9000000357627869;" x1="241.125" x2="241.125" y1="799.5305" y2="811.5305"/><polygon fill="#A80036" points="238.725,805.5305,241.125,811.5305,243.525,805.5305,241.125,807.9305" style="stroke: #A80036; stroke-width: 0.6000000238418579;"/><!--
@startuml
start

title Алгоритм обновление состояния \n входящих звонков

:Получение сообщения \nFullCallList/ShortCallList;

:Сериалиация в структуру FullCallsList;

:Отправка сообщения в очередь;

:Получение сообщения из очереди;

if (Состояние звонка - завершено?) then (да)
    if (Звонок есть в кэше?) then (да)
        partition "Завершение звонка" {
            :Установка времени завершения \nу каждого плеча;
            :Установка времени завершения у звонка;
            :Перевод звонка в состояние "завершен";
        }
        :Удаление звонка из кэша;
        :Преобразование в формат данных БД;
        :Сохранение в БД;
    endif
else (нет)
    partition "Создание звонка" {
        if (Звонок есть в кэше?) then (да)
            :Обновление состояние плеч;
        else (нет)
            :Создание новых плеч;
            :Обновление состояние плеч;
            :Определение типа звонка;
            :Создание нового звонка соответствующего типа;
            :Добавление звонка в кэш;
        endif
    }
    partition "Обновление звонка" {
        :Обновление данных;
        if (Звонка нет в Redis && \nзвонок прикреплен к проекту?) then (да)
            :Сохранение звонка в Redis;
        endif
    }
    if (Прикрепленный проект изменился?) then (да)
        :Завершение звонка;
        :Создание звонка;
        :Добавление звонка в кэш;
    endif
endif

stop

@enduml

PlantUML version 1.2018.11(Sat Sep 22 21:43:53 YEKT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1343-b26
Operating System: Linux
OS Version: 4.15.0-45-generic
Default Encoding: UTF-8
Language: ru
Country: RU
--></g></svg>